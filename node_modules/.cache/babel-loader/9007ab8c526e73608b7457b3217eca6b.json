{"ast":null,"code":"import _regeneratorRuntime from \"D:/HTML_CSS/popcorn-v3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/HTML_CSS/popcorn-v3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.function.name.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UserApi from '../../api/UserApi';\nexport default {\n  name: \"ui-home\",\n  components: {},\n  data: function data() {\n    return {\n      searchKey: '',\n      activeTab: 0,\n      myNav: false,\n      navColor: 'transparent',\n      pageRoutes: [{\n        title: \"Movies\",\n        route: \"/movies\"\n      }, {\n        title: \"TV Shows\",\n        route: \"/tvshows\"\n      }, {\n        title: \"Series\",\n        route: \"/series\"\n      }],\n      currentUser: null,\n      pageAlert: {\n        msg: 'Logging you out...',\n        process: true,\n        icon: 'mdi-information-outline',\n        vissible: false,\n        routeName: null\n      }\n    };\n  },\n  created: function created() {\n    window.addEventListener('scroll', this.onScroll);\n  },\n  destroyed: function destroyed() {\n    window.removeEventListener('scroll', this.onScroll);\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this.loadUser();\n\n            case 2:\n              _this.setActiveTab();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  watch: {\n    '$route': 'setActiveTab'\n  },\n  methods: {\n    loadUser: function loadUser() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(localStorage.getItem('token') != null)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                _context2.next = 3;\n                return UserApi.findToken(localStorage.getItem('token'));\n\n              case 3:\n                _this2.currentUser = _context2.sent;\n                if (_this2.currentUser.length < 1) localStorage.removeItem('token');\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    },\n    onScroll: function onScroll() {\n      var opacity = Math.round(0 + window.pageYOffset * 0.01 * 100) / 100;\n\n      if (opacity < 1) {\n        this.navColor = 'rgb(30,30,30,' + opacity + ')';\n      } else {\n        this.navColor = 'rgb(30,30,30,1)';\n      }\n    },\n    //Login redirect\n    goLogin: function goLogin() {\n      this.$router.push(\"/login\");\n    },\n    goCollections: function goCollections(_type) {\n      this.$router.push({\n        path: '/collections/',\n        query: {\n          type: _type\n        }\n      });\n    },\n    goHome: function goHome() {\n      this.activeTab = 0;\n      this.$router.push(\"/home\");\n    },\n    setActiveTab: function setActiveTab() {\n      switch (this.$route.name) {\n        case \"Home\":\n          this.activeTab = 0;\n          break;\n\n        case \"Collections\":\n          switch (this.$route.query.type) {\n            case \"movie\":\n              this.activeTab = 1;\n              break;\n\n            case \"series\":\n              this.activeTab = 2;\n              break;\n\n            default:\n              break;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n    },\n    goSearch: function goSearch($event) {\n      if ($event.key == \"Enter\" && this.searchKey != '') {\n        this.$router.push({\n          path: '/search',\n          query: {\n            key: this.searchKey\n          }\n        });\n      }\n    },\n    goProfile: function goProfile() {\n      this.activeTab = 0;\n      this.$router.push('/profile');\n    },\n    goLogout: function goLogout() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this3.pageAlert.vissible = true;\n                _this3.currentUser[0]._token = '';\n                _context3.next = 4;\n                return UserApi.update(_this3.currentUser[0]._id, _this3.currentUser);\n\n              case 4:\n                result = _context3.sent;\n                //set token in db to ''\n                localStorage.removeItem('token');\n                _this3.pageAlert.vissible = false;\n                console.log(result);\n                _this3.currentUser = null;\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA;AACA;EACAA,eADA;EAEAC,cAFA;EAIAC;IAAA;MACAC,aADA;MAEAC,YAFA;MAGAC,YAHA;MAIAC,uBAJA;MAKAC,aACA;QAAAC;QAAAC;MAAA,CADA,EAEA;QAAAD;QAAAC;MAAA,CAFA,EAGA;QAAAD;QAAAC;MAAA,CAHA,CALA;MAUAC,iBAVA;MAWAC;QACAC,yBADA;QAEAC,aAFA;QAGAC,+BAHA;QAIAC,eAJA;QAKAC;MALA;IAXA;EAAA,CAJA;EAuBAC,OAvBA,qBAuBA;IACAC;EACA,CAzBA;EA0BAC,SA1BA,uBA0BA;IACAD;EACA,CA5BA;EA6BAE,OA7BA,qBA6BA;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACA,gBADA;;YAAA;cAEA;;YAFA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAGA,CAhCA;EAiCAC;IACA;EADA,CAjCA;EAoCAC;IACAC,QADA,sBACA;MAAA;;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACAC,qCADA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAEAC,gDAFA;;cAAA;gBAEA,kBAFA;gBAGA;;cAHA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAKA,CANA;IAOAC,QAPA,sBAOA;MACA;;MACA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA,CAfA;IAiBA;IACAC,OAlBA,qBAkBA;MACA;IACA,CApBA;IAsBAC,aAtBA,yBAsBAC,KAtBA,EAsBA;MACA;QAAAC;QAAAC;UAAAC;QAAA;MAAA;IACA,CAxBA;IA0BAC,MA1BA,oBA0BA;MACA;MACA;IACA,CA7BA;IA8BAC,YA9BA,0BA8BA;MACA;QACA;UACA;UACA;;QACA;UACA;YACA;cACA;cACA;;YACA;cACA;cACA;;YACA;cACA;UARA;;UAUA;;QACA;UACA;MAjBA;IAmBA,CAlDA;IAoDAC,QApDA,oBAoDAC,MApDA,EAoDA;MACA;QACA;UAAAN;UAAAC;YAAAM;UAAA;QAAA;MACA;IACA,CAxDA;IAyDAC,SAzDA,uBAyDA;MACA;MACA;IACA,CA5DA;IA6DAC,QA7DA,sBA6DA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACA;gBAFA;gBAAA,OAGAd,6DAHA;;cAAA;gBAGAe,MAHA;gBAGA;gBACAhB;gBACA;gBACAiB;gBACA;;cAPA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAQA;EArEA;AApCA","names":["name","components","data","searchKey","activeTab","myNav","navColor","pageRoutes","title","route","currentUser","pageAlert","msg","process","icon","vissible","routeName","created","window","destroyed","mounted","watch","methods","loadUser","localStorage","UserApi","onScroll","goLogin","goCollections","_type","path","query","type","goHome","setActiveTab","goSearch","$event","key","goProfile","goLogout","result","console"],"sourceRoot":"src/components/home","sources":["Main.vue"],"sourcesContent":["<template>\r\n  <v-app>\r\n    <v-app-bar dark class=\"fixed-app-bar\" elevation=\"0\" flat :color=\"navColor\">\r\n      <v-app-bar-nav-icon class=\"hidden-md-and-up\" @click=\"myNav = true\">\r\n        <v-icon>mdi-menu</v-icon>\r\n      </v-app-bar-nav-icon>\r\n      <v-app-bar-title class=\"hidden-sm-and-down\">\r\n        <h4 class=\"logo logo__text\">POPCORN</h4>\r\n      </v-app-bar-title>\r\n      <v-tabs v-model=\"activeTab\" class=\"hidden-sm-and-down\" align-with-title :style=\"`width: unset`\">\r\n        <v-tabs-slider color=\"primary\"></v-tabs-slider>\r\n        <v-tab\r\n          active-class=\"tab--active\"\r\n          @click=\"goHome()\"\r\n          >Home</v-tab\r\n        >\r\n         <v-tab\r\n          active-class=\"tab--active\"\r\n          @click=\"goCollections('movie')\"\r\n          >Movies</v-tab\r\n        >\r\n         <v-tab\r\n          active-class=\"tab--active\"\r\n          @click=\"goCollections('series')\"\r\n          >Series</v-tab\r\n        >\r\n      </v-tabs>\r\n      <v-text-field\r\n        v-model=\"searchKey\"\r\n        @keypress=\"goSearch($event)\"\r\n        hide-details\r\n        dense\r\n        outlined\r\n        label=\"SEARCH\"\r\n        single-line\r\n        append-icon=\"mdi-magnify\"\r\n        color=\"#e31e2d\"\r\n      ></v-text-field>\r\n      <v-btn v-if=\"currentUser === null\" @click=\"goLogin()\" color=\"primary\" class=\"mx-2\">Login</v-btn>\r\n      <v-card v-else flat color=\"transparent\"  class=\"d-flex mx-2 px-2\">\r\n        <v-badge\r\n          avatar\r\n          bottom\r\n          dot\r\n          bordered\r\n          overlap\r\n          color=\"success\"\r\n          offset-x=\"10\"\r\n          offset-y=\"10\"\r\n        >\r\n          <v-avatar color=\"primary\">\r\n            <v-img src=\"../../assets/reindeer.png\" alt=\"avt\"></v-img>\r\n          </v-avatar>\r\n        </v-badge>\r\n        <h4 v-if=\"currentUser != null\" class=\"align-self-center px-3 hidden-sm-and-down\">{{ currentUser[0]._username }}</h4>\r\n        <v-menu :style=\"`box-shadow: none !important`\" transition=\"slide-y-transition\" min-width=\"175px\" nudge-bottom=\"50px\" :rounded=\"true\">\r\n          <template v-slot:activator=\"{ on, attrs }\">\r\n            <v-btn class=\"align-self-center btn--active\" color=\"transparent\" elevation=\"0\" small v-bind=\"attrs\" v-on=\"on\">\r\n              <v-icon>mdi-chevron-down</v-icon>\r\n            </v-btn>\r\n          </template>\r\n          <v-list>\r\n            <v-list-item  class=\"profile-item\">\r\n              <v-list-item-icon><v-icon class=\"profile-item__icon\">mdi-movie</v-icon></v-list-item-icon>\r\n              <v-list-item-title class=\"profile-item__text\">Gallery</v-list-item-title>\r\n            </v-list-item>\r\n             <v-list-item @click=\"goProfile()\"  class=\"profile-item\" link >\r\n              <v-list-item-icon><v-icon class=\"profile-item__icon\">mdi-account</v-icon></v-list-item-icon>\r\n              <v-list-item-title class=\"profile-item__text\">Profile</v-list-item-title>\r\n            </v-list-item>\r\n            <v-list-item @click=\"goLogout()\"  class=\"profile-item\" link >\r\n              <v-list-item-icon><v-icon class=\"profile-item__icon\">mdi-logout-variant</v-icon></v-list-item-icon>\r\n              <v-list-item-title class=\"profile-item__text\">Log out</v-list-item-title>\r\n            </v-list-item>\r\n          </v-list>\r\n        </v-menu>\r\n      </v-card>\r\n    </v-app-bar>\r\n    <v-navigation-drawer v-model=\"myNav\" app temporary>\r\n      <v-list nav>\r\n        <v-list-item>\r\n           <v-list-item-title @click=\"goHome()\">Home</v-list-item-title>\r\n        </v-list-item>\r\n        <v-list-item>\r\n           <v-list-item-title @click=\"goCollections('series')\">Series</v-list-item-title>\r\n        </v-list-item>\r\n        <v-list-item>\r\n           <v-list-item-title @click=\"goCollections('movie')\">Movies</v-list-item-title>\r\n        </v-list-item>\r\n      </v-list>\r\n    </v-navigation-drawer>\r\n    <v-main>\r\n        <router-view @loadUser=\"loadUser()\" ></router-view>\r\n    </v-main>\r\n    <div class=\"alert\">\r\n       <v-alert :value=\"pageAlert.vissible\" transition=\"slide-x-transition\" elevation=\"6\" color=\"white\" class=\"page__alert\">\r\n         <v-progress-circular v-if=\"pageAlert.process === true\" size=\"20\" class=\"mr-3\" indeterminate color=\"primary\"></v-progress-circular>\r\n         <v-icon v-else>{{pageAlert.icon}}</v-icon>\r\n          {{pageAlert.msg}}\r\n       </v-alert>\r\n    </div>\r\n  </v-app>\r\n</template>\r\n\r\n<script>\r\n\r\nimport UserApi from '../../api/UserApi'\r\nexport default {\r\n  name: \"ui-home\",\r\n  components: {\r\n  },\r\n  data: () => ({\r\n    searchKey: '',\r\n    activeTab: 0,\r\n    myNav: false,\r\n    navColor: 'transparent',\r\n    pageRoutes: [\r\n      { title: \"Movies\", route: \"/movies\" },\r\n      { title: \"TV Shows\", route: \"/tvshows\" },\r\n      { title: \"Series\", route: \"/series\" },\r\n    ],\r\n    currentUser: null,\r\n    pageAlert:{\r\n      msg: 'Logging you out...',\r\n      process: true,\r\n      icon: 'mdi-information-outline',\r\n      vissible: false,\r\n      routeName: null,\r\n    },\r\n  }),\r\n  created(){\r\n    window.addEventListener('scroll', this.onScroll)\r\n  },\r\n  destroyed(){\r\n    window.removeEventListener('scroll', this.onScroll)\r\n  },\r\n  async mounted(){\r\n    await this.loadUser()\r\n    this.setActiveTab()\r\n  },\r\n  watch:{\r\n    '$route': 'setActiveTab'\r\n  },\r\n  methods: {\r\n    async loadUser(){\r\n      if(localStorage.getItem('token')!= null){\r\n      this.currentUser = await UserApi.findToken(localStorage.getItem('token'))\r\n      if(this.currentUser.length < 1) localStorage.removeItem('token')\r\n    }\r\n    },\r\n    onScroll(){\r\n      let opacity = Math.round(0 + window.pageYOffset*0.01*100)/100;\r\n      if(opacity<1) {\r\n        this.navColor = 'rgb(30,30,30,' + opacity + ')'\r\n      }\r\n      else{\r\n        this.navColor = 'rgb(30,30,30,1)'\r\n      }\r\n    },\r\n\r\n    //Login redirect\r\n    goLogin(){\r\n      this.$router.push(\"/login\")\r\n    },\r\n\r\n    goCollections(_type){\r\n      this.$router.push({path: '/collections/', query:{type: _type}})\r\n    },\r\n\r\n    goHome(){\r\n      this.activeTab = 0\r\n      this.$router.push(\"/home\")\r\n    },\r\n    setActiveTab(){\r\n      switch (this.$route.name) {\r\n        case \"Home\":\r\n          this.activeTab = 0\r\n          break;\r\n        case \"Collections\":\r\n          switch (this.$route.query.type) {\r\n            case \"movie\":\r\n             this.activeTab = 1\r\n              break;\r\n            case \"series\":\r\n              this.activeTab = 2\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n          break\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n\r\n    goSearch($event){\r\n      if($event.key == \"Enter\" && this.searchKey != ''){\r\n        this.$router.push({path: '/search', query: {key: this.searchKey}})\r\n      }\r\n    },\r\n    goProfile(){\r\n      this.activeTab = 0\r\n      this.$router.push('/profile')\r\n    },\r\n    async goLogout(){\r\n      this.pageAlert.vissible = true\r\n      this.currentUser[0]._token = ''\r\n      const result = await UserApi.update(this.currentUser[0]._id, this.currentUser) //set token in db to ''\r\n      localStorage.removeItem('token')\r\n      this.pageAlert.vissible = false\r\n      console.log(result)\r\n      this.currentUser = null\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n*,\r\nhtml {\r\n  font-family: \"Akshar\", sans-serif;\r\n}\r\n.logo__text {\r\n  font-size: 27px;\r\n  color: #e31e2d;\r\n}\r\n.tab--active {\r\n  color: #e31e2d !important;\r\n}\r\n.btn--active::before{\r\n    background: transparent !important;\r\n}\r\n.profile-item:hover .profile-item__icon{\r\n    color: #e31e2d !important;\r\n    transition: .5s;\r\n}\r\n.profile-item:hover .profile-item__text{\r\n    color: #e31e2d !important;\r\n    transition: .5s;\r\n}\r\n.profile-menu{\r\n    box-shadow: none !important;\r\n    border: 1px white solid !important;\r\n}\r\n.fixed-app-bar{\r\n    position: fixed !important;\r\n    width: 100%;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: 2;\r\n}\r\n.alert .page__alert{\r\n  position: fixed;\r\n  bottom: 10px;\r\n  left: 10px;\r\n}\r\n@media only screen and (max-width: 600px) {\r\n  .tab__xs-none{\r\n    display: none;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}